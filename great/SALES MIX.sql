delete from uat_product.GD_SALES_MIX;insert into uat_product.GD_SALES_MIXwith branch as (		sel DISTINCT                b.branch_id,				case branch_name when 'Красноярск' then 'Сибирь' else b.macro_cc_name end macro_cc_name,				b.product_cluster_name,				r.region_name        from PRD2_DIC_V.BRANCH b        inner join PRD2_DIC_V.REGION r            on b.region_id=r.region_id        where product_cluster_name is not null            and branch_id is not null            and b.branch_name not like '%CDMA%'            and b.branch_name not like '%MVNO%'            and b.branch_name not like '%LTE450%'            and b.product_cluster_name<>'Deferred'            ),            name_report as (		 sel            case when name_report in ('Классический','Мой разговор','Мой Tele2','Мой онлайн','Мой онлайн+','Безлимит','Везде онлайн') then name_report                when name_report in ('Везде онлайн +','Везде онлайн+') then 'Везде онлайн+'             	else 'Other'            end as name_report,            min(tp_id) as tp_id        from PRD2_DIC_V.PRICE_PLAN        group by 1        )            sel 	report_date as report_month,	branch.region_name as region,	param_2 as channel,	branch.macro_cc_name as macroregion,	branch.product_cluster_name as "cluster",	name_report as tariff,	param_value as subs_countfrom UAT_PRODUCT.PRODUCT_PARAMETERS ppleft join branch	on pp.branch_id = branch.branch_idleft join name_report	on pp.tp_id_1 = name_report.tp_idWHERE param_1 = 'SM Plan';----create multiset table uat_product.GD_SALES_MIX as ----	(------ --with branch as (--		sel DISTINCT--                b.branch_id,--				case branch_name when 'Красноярск' then 'Сибирь' else b.macro_cc_name end macro_cc_name,--				b.product_cluster_name,--				r.region_name--        from PRD2_DIC_V.BRANCH b--        inner join PRD2_DIC_V.REGION r--            on b.region_id=r.region_id--        where product_cluster_name is not null--            and branch_id is not null--            and b.branch_name not like '%CDMA%'--            and b.branch_name not like '%MVNO%'--            and b.branch_name not like '%LTE450%'--            and b.product_cluster_name<>'Deferred'--            ),--            --name_report as (--		 sel--            case when name_report in--                ('Классический','Мой разговор','Везде онлайн','Мой Tele2','Мой онлайн','Мой онлайн+','Безлимит')--            then name_report--            else 'Other'--            end as name_report,--            min(tp_id) as tp_id--        from PRD2_DIC_V.PRICE_PLAN--        group by 1--        )--            ----sel --	report_date as report_month,--	branch.region_name as region,--	param_2 as channel,--	branch.macro_cc_name as macroregion,--	branch.product_cluster_name as "cluster",--	name_report as tariff,--	param_value as subs_count--from UAT_PRODUCT.PRODUCT_PARAMETERS pp--left join branch--	on pp.branch_id = branch.branch_id--left join name_report--	on pp.tp_id_1 = name_report.tp_id--WHERE param_1 = 'SM Plan'------	)--with no data--primary index(report_month, region, channel, tariff)